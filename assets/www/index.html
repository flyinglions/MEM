<!DOCTYPE HTML>
<html>
<head>
    <!-- Adding a comment to test -->
        <title>
            List of all the Graphs
        </title>
        
        <link rel="stylesheet" href="./theme/Wikus/WikusTheme.css" />
        <link rel="stylesheet" href="./theme/Wikus/jquery.mobile.structure-1.1.0.min.css" />
        <script src="./theme/Wikus/jquery-1.7.1.min.js"></script>
        <script src="./theme/Wikus/jquery.mobile-1.1.0.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="cordova-1.9.0.js"></script>
		<script type="text/javascript" charset="utf-8" src="smsread.js"></script>
		<script type="text/javascript" charset="utf-8" src="SMSReceiverPlugin.js"></script>
		<script type="text/javascript" charset="utf-8" src="common.js"></script>
		<script type="text/javascript" charset="utf-8" src="statusbarnotification.js"></script>  
        
        

        <script type="text/javascript">
            function redirect(val)
            {
                window.location = val;
            }
        </script>
        <script class="code" type="text/javascript">

        function startLoading(val)
        {
            $('div#loading').show();
            var wait = ((Math.random()*3)+1)*1000;
            var t = setTimeout("redirect('"+val+"/index.html')",wait);
        }

        function stopLoading()
        {
            $('div#loading').hide();
        }

        //startLoading();

        $(document).ready(function()
        {
            stopLoading();
        });

        </script>		
        <script type="text/javascript" src="./javascript/Queue.compressed.js"></script>
    <script type="text/javascript">

    // Wait for Cordova to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);
    
    var db = null;
    var functionQueue = new Queue();
    var typeQueue = new Queue();

    // Create the database, if not exist
    function queryDB(tx)
    {        
        var length = functionQueue.getLength();
        
        for(var i=0; i < length; i++)
        {
            //alert();
            var type = typeQueue.dequeue();
            if(type == "SELECT")
            {
                tx.executeSql(functionQueue.dequeue(), [], querySuccess, error);
            }
            else
            {
                tx.executeSql(functionQueue.dequeue());
            }
        }
        
        global_trans = tx;
    }

    // Query the database


    // Transaction error callback
    function error(err) 
    {
        console.log("Error processing SQL: "+err.code);
    }

    // Transaction success callback
    function success() 
    {
        console.log("success on database transaction.");
    }

    // Cordova is ready
    function onDeviceReady() 
    {
        db = window.openDatabase("Database", "1.0", "Flying Lions Database", 10485760);
        
        functionQueue.enqueue('DROP TABLE Bank_Account');
        typeQueue.enqueue('DROP');
        
        functionQueue.enqueue('DROP TABLE Budget_Items');
        typeQueue.enqueue('DROP');
        
        functionQueue.enqueue('DROP TABLE User');
        typeQueue.enqueue('DROP');
        
        functionQueue.enqueue('DROP TABLE sms');
        typeQueue.enqueue('DROP');
        
        functionQueue.enqueue('DROP TABLE Reconciliation');
        typeQueue.enqueue('DROP');
        /*
        //Create Table Bank_Account
        functionQueue.enqueue('CREATE TABLE IF NOT EXISTS Bank_Account (Account_Number UNIQUE, Bank, Account_Name, Balance_Available, User_ID)');
        typeQueue.enqueue('CREATE');
        //Create Table Budget_Items
        functionQueue.enqueue('CREATE TABLE IF NOT EXISTS Budget_Items (Item_ID UNIQUE,Category,Budgeted_Amount,Remaining_Amount,User_ID)');
        typeQueue.enqueue('CREATE');
        //Create Table User
        functionQueue.enqueue('CREATE TABLE IF NOT EXISTS User (User_ID,User_Name,Password)');
        typeQueue.enqueue('CREATE');
        //Create Table sms
        functionQueue.enqueue('CREATE TABLE IF NOT EXISTS sms (SMS_ID,Date,Transaction_Type,Amount,Balance_Available,Location,Account_Number)');
        typeQueue.enqueue('CREATE');
        //Create Table Reconciliation
        functionQueue.enqueue('CREATE TABLE IF NOT EXISTS Reconciliation (Transaction_ID,Category,Type,Recon,Account_Number,SMS_ID)');
        typeQueue.enqueue('CREATE');
        */
        checkQueue();
    }
    
    function querySuccess(tx, results) 
    {
        var len = results.rows.length;
        //console.log("DEMO table: " + len + " rows found.");
        for (var i=0; i<len; i++)
        {
            alert(results.rows.item(i).User_Name);
            //console.log("Row = " + i + " ID = " + results.rows.item(i).id + " Data =  " + results.rows.item(i).data);
        }
    }
    
    function checkQueue()
    {
        db.transaction(queryDB, error, success);
    }

    </script>
</head>
<body onload="init()">
		
        <div id="loader" data-role="page" data-theme="a">
            <div data-role="header" data-position="inline">
                <h1>Mobile Expenditure Manager</h1>
            </div>
            <div data-role="content" data-theme="a">
                <input class="button" type="button" value="Accounts" onclick="redirect('Accounts.html');"/><br />
                <input class="button" type="button" value="Settings" onclick="redirect('Settings.html');"/><br />
                <input class="button" type="button" value="Reports" onclick="redirect('graphMenu.html')"/><br />
                <input class="button" type="button" value="Add Manual" onclick="redirect('addManual.html')"/><br />
                <div id="loading" style="display: inline" class="ui-loader ui-corner-all ui-body-a ui-loader-verbose">
                <span class="ui-icon ui-icon-loading"></span>
                <h1>Loading...</h1>
                </div>
            </div>
        </div>		
    
</body>

</html>